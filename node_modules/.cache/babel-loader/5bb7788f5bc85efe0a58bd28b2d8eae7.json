{"ast":null,"code":"import _classCallCheck from \"D:\\\\mzamal\\\\sales&stock\\\\sales\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\mzamal\\\\sales&stock\\\\sales\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\mzamal\\\\sales&stock\\\\sales\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\mzamal\\\\sales&stock\\\\sales\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\mzamal\\\\sales&stock\\\\sales\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"D:\\\\mzamal\\\\sales&stock\\\\sales\\\\src\\\\components\\\\reports\\\\pages\\\\AllReports.jsx\";\nimport React, { Component } from 'react';\nimport { MDBDataTable, MDBCard, MDBCardHeader, MDBCardBody, MDBBtn, MDBIcon, MDBContainer, MDBRow, MDBCol, MDBInput } from 'mdbreact';\nimport { Can } from \"../../../configs/Ability-context\";\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport 'react-datepicker/dist/react-datepicker-cssmodules.css';\n\nvar AllReports =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AllReports, _Component);\n\n  function AllReports() {\n    var _this;\n\n    _classCallCheck(this, AllReports);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AllReports).call(this));\n    _this._isMounted = false;\n\n    _this.componentWillUnmount = function () {\n      _this._isMounted = false;\n    };\n\n    _this.handleDateChange = function (value) {\n      _this.setState({\n        fromDate: value\n      });\n\n      var selectedOrderDetails = _this.state.orderDetails.filter(function (orderDetail) {\n        return new Date(orderDetail.order_date) > value;\n      });\n\n      console.log(value);\n      console.log(new Date(1 / 1 / 1900));\n      console.log(selectedOrderDetails);\n\n      _this.setState({\n        orderDetails: selectedOrderDetails\n      });\n    };\n\n    _this.totalSales = function () {\n      var Total = 0;\n\n      _this.state.orderDetails.forEach(function (orderDetail) {\n        Total = Total + Number(orderDetail.product_price);\n      });\n\n      return Total;\n    };\n\n    _this.totalValueAdded = function () {\n      var Total = 0;\n\n      var details = _this.state.orderDetails.filter(function (orderDetail) {\n        return orderDetail.product_extra_added === 'Yes';\n      });\n\n      details.forEach(function (detail) {\n        Total = Total + Number(detail.product_price);\n      });\n      return Total;\n    };\n\n    _this._isMounted = true;\n    fetch('/getAllOrderDetails').then(function (res) {\n      return res.json();\n    }).then(function (json) {\n      console.log(json);\n      var orderDetails = json.data; // orderDetails.forEach(x => { console.log(x.order_date); }\n      // )\n      // orderDetails.map((x) => {\n      //     delete x.createdAt;\n      //     delete x.updatedAt;\n      //     delete x.deletedAt;\n      //     delete x.id;\n      //     delete x.order_id;\n      //     if (x.order_date === null) {\n      //         x.order_date = new Date(\"2000-01-01T00:00:00.000Z\").toLocaleDateString()\n      //     }\n      //     else {\n      //         console.log(x.order_date);\n      //         x.order_date = new Date(x.order_date).toLocaleDateString()\n      //         console.log(x.order_date);\n      //     }\n      // });\n\n      if (_this._isMounted) {\n        _this.setState({\n          orderDetails: orderDetails\n        });\n      }\n    })[\"catch\"](function (error) {\n      return console.log(error);\n    });\n    _this.state = {\n      orderDetails: [],\n      fromDate: new Date()\n    };\n    return _this;\n  }\n\n  _createClass(AllReports, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          orderDetails = _this$state.orderDetails,\n          fromDate = _this$state.fromDate;\n      var rows = [];\n      var index = 0;\n      orderDetails.forEach(function (orderDetail) {\n        index = index + 1;\n        var date;\n\n        if (orderDetail.order_date === null) {\n          date = new Date(\"2019-07-08T00:00:00.000Z\");\n        } else {\n          console.log(orderDetail.order_date);\n          date = new Date(orderDetail.order_date).toLocaleDateString();\n        }\n\n        rows.push({\n          index: index,\n          product_name: order.order_id,\n          product_sku: order.customer_name,\n          product_rate: order.customer_contact,\n          cAddress: order.customer_address,\n          total: order.total,\n          tracking: order.tracking_id,\n          note: order.note,\n          status: order.status,\n          order_date: date\n        });\n      });\n      var data = {\n        columns: [{\n          label: 'Name',\n          field: 'product_name'\n        }, {\n          label: 'SKU',\n          field: 'product_sku'\n        }, {\n          label: 'Rate',\n          field: 'product_rate'\n        }, {\n          label: 'QTY',\n          field: 'product_qty'\n        }, {\n          label: 'Price',\n          field: 'product_price'\n        }, {\n          label: 'Remarks',\n          field: 'product_remarks'\n        }, {\n          label: 'Extra Added',\n          field: 'product_extra_added'\n        }, {\n          label: 'Date',\n          field: 'order_date'\n        }],\n        rows: orderDetails\n      };\n      return React.createElement(Can, {\n        I: \"read\",\n        a: \"report\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(MDBContainer, {\n        className: \"\",\n        fluid: true,\n        style: {\n          marginTop: '80px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(MDBRow, {\n        center: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, React.createElement(MDBCol, {\n        sm: \"10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(MDBCard, {\n        className: \" p-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(MDBCardHeader, {\n        tag: \"h4\",\n        style: {\n          color: 'teal'\n        },\n        className: \"text-center font-weight-bold\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, \"Order-details Reports\"), React.createElement(MDBCardBody, {\n        className: \"p-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(MDBRow, {\n        className: \"m-0 p-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"Select Date from which you want to fetch report.\"), React.createElement(MDBCol, {\n        md: \"12\",\n        className: \"m-0 p-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(MDBCol, {\n        md: \"3\",\n        className: \"m-0 p-0\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(DatePicker, {\n        id: \"datePicker\",\n        selected: fromDate,\n        onChange: this.handleDateChange,\n        className: \"form-control\",\n        peekNextMonth: true,\n        showMonthDropdown: true,\n        showYearDropdown: true,\n        dropdownMode: \"select\",\n        autoComplete: \"off\",\n        dateFormat: \"dd/MM/yy\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      })))), React.createElement(MDBDataTable, {\n        id: \"reportsTable\",\n        striped: true,\n        small: true,\n        hover: true,\n        theadColor: \"teal\",\n        bordered: true,\n        btn: true,\n        entries: 12,\n        entriesOptions: [5, 10, 20, 35, 55, 70, 100, 135],\n        responsive: true,\n        data: data,\n        theadTextWhite: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }), React.createElement(MDBRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(MDBCol, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(MDBInput, {\n        type: \"text\",\n        label: \"Total Sales\",\n        value: this.totalSales(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      })), React.createElement(MDBCol, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(MDBInput, {\n        type: \"text\",\n        label: \"Total Value Added\",\n        value: this.totalValueAdded(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      })))))))));\n    }\n  }]);\n\n  return AllReports;\n}(Component);\n\nexport default AllReports;","map":{"version":3,"sources":["D:\\mzamal\\sales&stock\\sales\\src\\components\\reports\\pages\\AllReports.jsx"],"names":["React","Component","MDBDataTable","MDBCard","MDBCardHeader","MDBCardBody","MDBBtn","MDBIcon","MDBContainer","MDBRow","MDBCol","MDBInput","Can","DatePicker","AllReports","_isMounted","componentWillUnmount","handleDateChange","value","setState","fromDate","selectedOrderDetails","state","orderDetails","filter","orderDetail","Date","order_date","console","log","totalSales","Total","forEach","Number","product_price","totalValueAdded","details","product_extra_added","detail","fetch","then","res","json","data","error","rows","index","date","toLocaleDateString","push","product_name","order","order_id","product_sku","customer_name","product_rate","customer_contact","cAddress","customer_address","total","tracking","tracking_id","note","status","columns","label","field","marginTop","color"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { MDBDataTable, MDBCard, MDBCardHeader, MDBCardBody, MDBBtn, MDBIcon, MDBContainer, MDBRow, MDBCol, MDBInput } from 'mdbreact';\r\nimport { Can } from \"../../../configs/Ability-context\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\nimport 'react-datepicker/dist/react-datepicker-cssmodules.css';\r\n\r\n\r\nclass AllReports extends Component {\r\n    _isMounted = false\r\n    constructor() {\r\n        super();\r\n        this._isMounted = true\r\n        fetch('/getAllOrderDetails')\r\n            .then((res) => res.json())\r\n            .then((json) => {\r\n                console.log(json)\r\n                let orderDetails = json.data\r\n                // orderDetails.forEach(x => { console.log(x.order_date); }\r\n                // )\r\n                // orderDetails.map((x) => {\r\n                //     delete x.createdAt;\r\n                //     delete x.updatedAt;\r\n                //     delete x.deletedAt;\r\n                //     delete x.id;\r\n                //     delete x.order_id;\r\n                //     if (x.order_date === null) {\r\n                //         x.order_date = new Date(\"2000-01-01T00:00:00.000Z\").toLocaleDateString()\r\n                //     }\r\n                //     else {\r\n                //         console.log(x.order_date);\r\n\r\n                //         x.order_date = new Date(x.order_date).toLocaleDateString()\r\n                //         console.log(x.order_date);\r\n                //     }\r\n                // });\r\n                if (this._isMounted) {\r\n                    this.setState({ orderDetails: orderDetails })\r\n                }\r\n            })\r\n            .catch((error) => console.log(error))\r\n        this.state = {\r\n            orderDetails: [],\r\n            fromDate: new Date()\r\n        }\r\n    }\r\n\r\n    componentWillUnmount = () => {\r\n        this._isMounted = false\r\n    }\r\n\r\n    // handling date value\r\n\r\n    handleDateChange = (value) => {\r\n        this.setState({\r\n            fromDate: value\r\n        });\r\n        let selectedOrderDetails = this.state.orderDetails.filter(orderDetail => new Date(orderDetail.order_date) > value)\r\n        console.log(value);\r\n        console.log(new Date(1 / 1 / 1900));\r\n        console.log(selectedOrderDetails);\r\n        this.setState({\r\n            orderDetails: selectedOrderDetails\r\n        })\r\n\r\n    }\r\n\r\n    totalSales = () => {\r\n        let Total = 0;\r\n        this.state.orderDetails.forEach(orderDetail => {\r\n            Total = Total + Number(orderDetail.product_price)\r\n        })\r\n        return Total\r\n    }\r\n\r\n    totalValueAdded = () => {\r\n        let Total = 0;\r\n        let details = this.state.orderDetails.filter(orderDetail => orderDetail.product_extra_added === 'Yes')\r\n        details.forEach(detail => {\r\n            Total = Total + Number(detail.product_price)\r\n        })\r\n        return Total\r\n\r\n    }\r\n\r\n    render() {\r\n        var { orderDetails, fromDate } = this.state;\r\n        var rows = [];\r\n        var index = 0;\r\n        orderDetails.forEach((orderDetail) => {\r\n\r\n            index = index + 1;\r\n            let date;\r\n            if (orderDetail.order_date === null) {\r\n                date = new Date(\"2019-07-08T00:00:00.000Z\")\r\n            }\r\n            else {\r\n                console.log(orderDetail.order_date);\r\n\r\n                date = new Date(orderDetail.order_date).toLocaleDateString();\r\n            }\r\n            rows.push(\r\n                {\r\n                    index: index,\r\n                    product_name: order.order_id,\r\n                    product_sku: order.customer_name,\r\n                    product_rate: order.customer_contact,\r\n                    cAddress: order.customer_address,\r\n                    total: order.total,\r\n                    tracking: order.tracking_id,\r\n                    note: order.note,\r\n                    status: order.status,\r\n                    order_date: date,\r\n                }\r\n            );\r\n        });\r\n\r\n        var data = {\r\n            columns: [\r\n                { label: 'Name', field: 'product_name' },\r\n                { label: 'SKU', field: 'product_sku' }, { label: 'Rate', field: 'product_rate' },\r\n                { label: 'QTY', field: 'product_qty' }, { label: 'Price', field: 'product_price' },\r\n                { label: 'Remarks', field: 'product_remarks' }, { label: 'Extra Added', field: 'product_extra_added' },\r\n                { label: 'Date', field: 'order_date' }\r\n            ],\r\n            rows: orderDetails\r\n        }\r\n        return (\r\n            <Can I='read' a='report'>\r\n                <MDBContainer className='' fluid style={{ marginTop: '80px' }}>\r\n                    <MDBRow center>\r\n                        <MDBCol sm=\"10\">\r\n                            <MDBCard className=' p-0'>\r\n                                <MDBCardHeader tag=\"h4\" style={{ color: 'teal' }} className=\"text-center font-weight-bold\">\r\n                                    Order-details Reports\r\n                            </MDBCardHeader>\r\n                                <MDBCardBody className='p-2'>\r\n                                    <MDBRow className='m-0 p-0' >\r\n                                        <label>Select Date from which you want to fetch report.</label>\r\n                                        <MDBCol md='12' className='m-0 p-0' >\r\n                                            <MDBCol md='3' className='m-0 p-0'>\r\n                                                <DatePicker\r\n                                                    id='datePicker'\r\n                                                    selected={fromDate}\r\n                                                    onChange={this.handleDateChange}\r\n                                                    className='form-control'\r\n                                                    peekNextMonth\r\n                                                    showMonthDropdown\r\n                                                    showYearDropdown\r\n                                                    dropdownMode=\"select\"\r\n                                                    autoComplete='off'\r\n                                                    dateFormat=\"dd/MM/yy\"\r\n                                                />\r\n                                            </MDBCol>\r\n                                        </MDBCol>\r\n                                    </MDBRow>\r\n\r\n                                    <MDBDataTable id='reportsTable' striped small hover theadColor=\"teal\"\r\n                                        bordered btn entries={12} entriesOptions={[5, 10, 20, 35, 55, 70, 100, 135]} responsive\r\n                                        data={data} theadTextWhite >\r\n                                    </MDBDataTable>\r\n                                    <MDBRow>\r\n                                        <MDBCol>\r\n\r\n                                            <MDBInput type='text' label='Total Sales' value={this.totalSales()} />\r\n                                        </MDBCol>\r\n                                        <MDBCol>\r\n                                            <MDBInput type='text' label='Total Value Added' value={this.totalValueAdded()} />\r\n                                        </MDBCol>\r\n                                    </MDBRow>\r\n\r\n\r\n                                </MDBCardBody>\r\n                            </MDBCard>\r\n                        </MDBCol>\r\n                    </MDBRow>\r\n                </MDBContainer>\r\n            </Can>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default AllReports"]},"metadata":{},"sourceType":"module"}